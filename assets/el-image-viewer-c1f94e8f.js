import{aZ as Z,bS as Ee,bz as ne,by as _e,c as k,bk as Le,O as Te,l as pe,m as ie,av as ge,a1 as de,d as se,bT as fe,bU as Ce,bV as xe,J as ye,a as be,bv as ze,h as x,bW as Se,a2 as Oe,s as oe,F as we,j as he,o as T,y as ue,A as y,z as S,Q as L,n as w,e as t,f as ce,S as Ne,N as O,H as X,ar as $e,b as V,T as ae,a6 as Re,a9 as Ae,bX as Be,bY as Me,R as Ve,bZ as Xe,b_ as Fe,$ as Ye,a5 as De,a7 as Pe,r as te,a8 as We,au as He,_ as ke,E as H,v as j,b$ as Ze,w as Ie,b9 as je,Z as Ue,M as Ke,a_ as qe,a4 as Ge,c0 as Je,c1 as Qe}from"./index-902dfc4b.js";const et=(n,l)=>{if(!Z||!n||!l)return!1;const s=n.getBoundingClientRect();let r;return l instanceof Element?r=l.getBoundingClientRect():r={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},s.top<r.bottom&&s.bottom>r.top&&s.right>r.left&&s.left<r.right};var tt=/\s/;function nt(n){for(var l=n.length;l--&&tt.test(n.charAt(l)););return l}var at=/^\s+/;function st(n){return n&&n.slice(0,nt(n)+1).replace(at,"")}var ve=0/0,rt=/^[-+]0x[0-9a-f]+$/i,lt=/^0b[01]+$/i,it=/^0o[0-7]+$/i,ot=parseInt;function me(n){if(typeof n=="number")return n;if(Ee(n))return ve;if(ne(n)){var l=typeof n.valueOf=="function"?n.valueOf():n;n=ne(l)?l+"":l}if(typeof n!="string")return n===0?n:+n;n=st(n);var s=lt.test(n);return s||it.test(n)?ot(n.slice(2),s?2:8):rt.test(n)?ve:+n}var ut=function(){return _e.Date.now()};const re=ut;var ct="Expected a function",dt=Math.max,ft=Math.min;function vt(n,l,s){var r,c,f,i,p,b,h=0,I=!1,g=!1,v=!0;if(typeof n!="function")throw new TypeError(ct);l=me(l)||0,ne(s)&&(I=!!s.leading,g="maxWait"in s,f=g?dt(me(s.maxWait)||0,l):f,v="trailing"in s?!!s.trailing:v);function m(o){var E=r,R=c;return r=c=void 0,h=o,i=n.apply(R,E),i}function d(o){return h=o,p=setTimeout($,l),I?m(o):i}function F(o){var E=o-b,R=o-h,D=l-E;return g?ft(D,f-R):D}function N(o){var E=o-b,R=o-h;return b===void 0||E>=l||E<0||g&&R>=f}function $(){var o=re();if(N(o))return P(o);p=setTimeout($,F(o))}function P(o){return p=void 0,v&&r?m(o):(r=c=void 0,i)}function Y(){p!==void 0&&clearTimeout(p),h=0,r=b=c=p=void 0}function U(){return p===void 0?i:P(re())}function z(){var o=re(),E=N(o);if(r=arguments,c=this,b=o,E){if(p===void 0)return d(b);if(g)return clearTimeout(p),p=setTimeout($,l),m(b)}return p===void 0&&(p=setTimeout($,l)),i}return z.cancel=Y,z.flush=U,z}var mt="Expected a function";function le(n,l,s){var r=!0,c=!0;if(typeof n!="function")throw new TypeError(mt);return ne(s)&&(r="leading"in s?!!s.leading:r,c="trailing"in s?!!s.trailing:c),vt(n,l,{leading:r,maxWait:l,trailing:c})}const pt=["class","style"],gt=/^on[A-Z]/,yt=(n={})=>{const{excludeListeners:l=!1,excludeKeys:s}=n,r=k(()=>((s==null?void 0:s.value)||[]).concat(pt)),c=Te();return c?k(()=>{var f;return Le(Object.entries((f=c.proxy)==null?void 0:f.$attrs).filter(([i])=>!r.value.includes(i)&&!(l&&gt.test(i))))}):k(()=>({}))},bt=pe({urlList:{type:ie(Array),default:()=>ge([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),wt={close:()=>!0,switch:n=>de(n)},ht=["src"],kt=se({name:"ElImageViewer"}),It=se({...kt,props:bt,emits:wt,setup(n,{expose:l,emit:s}){const r=n,c={CONTAIN:{name:"contain",icon:fe(Ce)},ORIGINAL:{name:"original",icon:fe(xe)}},{t:f}=ye(),i=be("image-viewer"),{nextZIndex:p}=ze(),b=x(),h=x([]),I=Se(),g=x(!0),v=x(r.initialIndex),m=Oe(c.CONTAIN),d=x({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),F=k(()=>{const{urlList:e}=r;return e.length<=1}),N=k(()=>v.value===0),$=k(()=>v.value===r.urlList.length-1),P=k(()=>r.urlList[v.value]),Y=k(()=>{const{scale:e,deg:a,offsetX:u,offsetY:_,enableTransition:B}=d.value;let C=u/e,M=_/e;switch(a%360){case 90:case-270:[C,M]=[M,-C];break;case 180:case-180:[C,M]=[-C,-M];break;case 270:case-90:[C,M]=[-M,C];break}const W={transform:`scale(${e}) rotate(${a}deg) translate(${C}px, ${M}px)`,transition:B?"transform .3s":""};return m.value.name===c.CONTAIN.name&&(W.maxWidth=W.maxHeight="100%"),W}),U=k(()=>de(r.zIndex)?r.zIndex:p());function z(){E(),s("close")}function o(){const e=le(u=>{switch(u.code){case H.esc:r.closeOnPressEscape&&z();break;case H.space:q();break;case H.left:Q();break;case H.up:A("zoomIn");break;case H.right:ee();break;case H.down:A("zoomOut");break}}),a=le(u=>{const _=u.deltaY||u.deltaX;A(_<0?"zoomIn":"zoomOut",{zoomRate:r.zoomRate,enableTransition:!1})});I.run(()=>{j(document,"keydown",e),j(document,"wheel",a)})}function E(){I.stop()}function R(){g.value=!1}function D(e){g.value=!1,e.target.alt=f("el.image.error")}function J(e){if(g.value||e.button!==0||!b.value)return;d.value.enableTransition=!1;const{offsetX:a,offsetY:u}=d.value,_=e.pageX,B=e.pageY,C=le(W=>{d.value={...d.value,offsetX:a+W.pageX-_,offsetY:u+W.pageY-B}}),M=j(document,"mousemove",C);j(document,"mouseup",()=>{M()}),e.preventDefault()}function K(){d.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function q(){if(g.value)return;const e=Ze(c),a=Object.values(c),u=m.value.name,B=(a.findIndex(C=>C.name===u)+1)%e.length;m.value=c[e[B]],K()}function G(e){const a=r.urlList.length;v.value=(e+a)%a}function Q(){N.value&&!r.infinite||G(v.value-1)}function ee(){$.value&&!r.infinite||G(v.value+1)}function A(e,a={}){if(g.value)return;const{zoomRate:u,rotateDeg:_,enableTransition:B}={zoomRate:r.zoomRate,rotateDeg:90,enableTransition:!0,...a};switch(e){case"zoomOut":d.value.scale>.2&&(d.value.scale=Number.parseFloat((d.value.scale/u).toFixed(3)));break;case"zoomIn":d.value.scale<7&&(d.value.scale=Number.parseFloat((d.value.scale*u).toFixed(3)));break;case"clockwise":d.value.deg+=_;break;case"anticlockwise":d.value.deg-=_;break}d.value.enableTransition=B}return oe(P,()=>{we(()=>{const e=h.value[0];e!=null&&e.complete||(g.value=!0)})}),oe(v,e=>{K(),s("switch",e)}),he(()=>{var e,a;o(),(a=(e=b.value)==null?void 0:e.focus)==null||a.call(e)}),l({setActiveItem:G}),(e,a)=>(T(),ue(He,{to:"body",disabled:!e.teleported},[y(We,{name:"viewer-fade",appear:""},{default:S(()=>[L("div",{ref_key:"wrapper",ref:b,tabindex:-1,class:w(t(i).e("wrapper")),style:ce({zIndex:t(U)})},[L("div",{class:w(t(i).e("mask")),onClick:a[0]||(a[0]=Ne(u=>e.hideOnClickModal&&z(),["self"]))},null,2),O(" CLOSE "),L("span",{class:w([t(i).e("btn"),t(i).e("close")]),onClick:z},[y(t(X),null,{default:S(()=>[y(t($e))]),_:1})],2),O(" ARROW "),t(F)?O("v-if",!0):(T(),V(ae,{key:0},[L("span",{class:w([t(i).e("btn"),t(i).e("prev"),t(i).is("disabled",!e.infinite&&t(N))]),onClick:Q},[y(t(X),null,{default:S(()=>[y(t(Re))]),_:1})],2),L("span",{class:w([t(i).e("btn"),t(i).e("next"),t(i).is("disabled",!e.infinite&&t($))]),onClick:ee},[y(t(X),null,{default:S(()=>[y(t(Ae))]),_:1})],2)],64)),O(" ACTIONS "),L("div",{class:w([t(i).e("btn"),t(i).e("actions")])},[L("div",{class:w(t(i).e("actions__inner"))},[y(t(X),{onClick:a[1]||(a[1]=u=>A("zoomOut"))},{default:S(()=>[y(t(Be))]),_:1}),y(t(X),{onClick:a[2]||(a[2]=u=>A("zoomIn"))},{default:S(()=>[y(t(Me))]),_:1}),L("i",{class:w(t(i).e("actions__divider"))},null,2),y(t(X),{onClick:q},{default:S(()=>[(T(),ue(Ve(t(m).icon)))]),_:1}),L("i",{class:w(t(i).e("actions__divider"))},null,2),y(t(X),{onClick:a[3]||(a[3]=u=>A("anticlockwise"))},{default:S(()=>[y(t(Xe))]),_:1}),y(t(X),{onClick:a[4]||(a[4]=u=>A("clockwise"))},{default:S(()=>[y(t(Fe))]),_:1})],2)],2),O(" CANVAS "),L("div",{class:w(t(i).e("canvas"))},[(T(!0),V(ae,null,Ye(e.urlList,(u,_)=>De((T(),V("img",{ref_for:!0,ref:B=>h.value[_]=B,key:u,src:u,style:ce(t(Y)),class:w(t(i).e("img")),onLoad:R,onError:D,onMousedown:J},null,46,ht)),[[Pe,_===v.value]])),128))],2),te(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var Et=ke(It,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const _t=Ie(Et),Lt=pe({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:ie([String,Object])},previewSrcList:{type:ie(Array),default:()=>ge([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),Tt={load:n=>n instanceof Event,error:n=>n instanceof Event,switch:n=>de(n),close:()=>!0,show:()=>!0},Ct=["src","loading"],xt={key:0},zt=se({name:"ElImage",inheritAttrs:!1}),St=se({...zt,props:Lt,emits:Tt,setup(n,{emit:l}){const s=n;let r="";const{t:c}=ye(),f=be("image"),i=je(),p=yt(),b=x(),h=x(!1),I=x(!0),g=x(!1),v=x(),m=x(),d=Z&&"loading"in HTMLImageElement.prototype;let F,N;const $=k(()=>i.style),P=k(()=>{const{fit:e}=s;return Z&&e?{objectFit:e}:{}}),Y=k(()=>{const{previewSrcList:e}=s;return Array.isArray(e)&&e.length>0}),U=k(()=>{const{previewSrcList:e,initialIndex:a}=s;let u=a;return a>e.length-1&&(u=0),u}),z=k(()=>s.loading==="eager"?!1:!d&&s.loading==="lazy"||s.lazy),o=()=>{Z&&(I.value=!0,h.value=!1,b.value=s.src)};function E(e){I.value=!1,h.value=!1,l("load",e)}function R(e){I.value=!1,h.value=!0,l("error",e)}function D(){et(v.value,m.value)&&(o(),q())}const J=Qe(D,200,!0);async function K(){var e;if(!Z)return;await we();const{scrollContainer:a}=s;qe(a)?m.value=a:Ge(a)&&a!==""?m.value=(e=document.querySelector(a))!=null?e:void 0:v.value&&(m.value=Je(v.value)),m.value&&(F=j(m,"scroll",J),setTimeout(()=>D(),100))}function q(){!Z||!m.value||!J||(F==null||F(),m.value=void 0)}function G(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function Q(){Y.value&&(N=j("wheel",G,{passive:!1}),r=document.body.style.overflow,document.body.style.overflow="hidden",g.value=!0,l("show"))}function ee(){N==null||N(),document.body.style.overflow=r,g.value=!1,l("close")}function A(e){l("switch",e)}return oe(()=>s.src,()=>{z.value?(I.value=!0,h.value=!1,q(),K()):o()}),he(()=>{z.value?K():o()}),(e,a)=>(T(),V("div",{ref_key:"container",ref:v,class:w([t(f).b(),e.$attrs.class]),style:ce(t($))},[h.value?te(e.$slots,"error",{key:0},()=>[L("div",{class:w(t(f).e("error"))},Ue(t(c)("el.image.error")),3)]):(T(),V(ae,{key:1},[b.value!==void 0?(T(),V("img",Ke({key:0},t(p),{src:b.value,loading:e.loading,style:t(P),class:[t(f).e("inner"),t(Y)&&t(f).e("preview"),I.value&&t(f).is("loading")],onClick:Q,onLoad:E,onError:R}),null,16,Ct)):O("v-if",!0),I.value?(T(),V("div",{key:1,class:w(t(f).e("wrapper"))},[te(e.$slots,"placeholder",{},()=>[L("div",{class:w(t(f).e("placeholder"))},null,2)])],2)):O("v-if",!0)],64)),t(Y)?(T(),V(ae,{key:2},[g.value?(T(),ue(t(_t),{key:0,"z-index":e.zIndex,"initial-index":t(U),infinite:e.infinite,"zoom-rate":e.zoomRate,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:ee,onSwitch:A},{default:S(()=>[e.$slots.viewer?(T(),V("div",xt,[te(e.$slots,"viewer")])):O("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):O("v-if",!0)],64)):O("v-if",!0)],6))}});var Ot=ke(St,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const $t=Ie(Ot);export{$t as E,vt as d,le as t,yt as u};
